# GRDB Database Layer

## Important: Column Naming Convention

All database tables use snake_case column names (e.g., `api_key`, `model_metadata_id`), while Swift properties use camelCase.

### Mapping Rules

1. **Record Types**: All `*Record` structs must define `CodingKeys` to map Swift properties to database columns
2. **Foreign Keys**: Generated by GRDB's `belongsTo` use camelCase (e.g., `model_metadataId`)
3. **Migrations**: Must use the actual column names that will be created

### Example

```swift
struct ConfigurationRecord: Codable {
    var apiKey: String?  // Swift property (camelCase)

    enum CodingKeys: String, CodingKey {
        case apiKey = "api_key"  // Database column (snake_case)
    }
}
```

### Foreign Key Columns

When using `belongsTo`, GRDB creates columns with camelCase names:
- `t.belongsTo("model_metadata")` creates `model_metadataId`
- `t.belongsTo("generation_sessions")` creates `generation_sessionsId`

Always use these exact names in indexes and constraints.
